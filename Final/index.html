<!-- Seth Coulter | July 22 2025 (Index) -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Midjourney Prompt Optimizer</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body class="bg-black text-white">

    <!-- Header Navigation -->
    <header class="bg-black/50 backdrop-blur-lg sticky top-0 z-50">
        <nav class="container mx-auto px-8 py-4 flex flex-col md:flex-row justify-center md:justify-between items-center space-y-4 md:space-y-0">
            <span class="text-lg font-bold">MJ Prompt Optimizer</span>
            <div class="flex flex-row space-x-8 text-sm font-light text-center">
                <a href="index.html#optimizer" class="hover:text-gray-300 transition-colors">Optimizer</a>
                <a href="examples.html" class="hover:text-gray-300 transition-colors">Examples</a>
                <a href="workflow.html" class="hover:text-gray-300 transition-colors">Workflow</a>
                <a href="whyitworks.html" class="hover:text-gray-300 transition-colors">Why It Works</a>
                <a href="about.html" class="hover:text-gray-300 transition-colors">About</a>
            </div>
        </nav>
    </header>

    <!-- Main Content -->
    <main class="px-8">
        
        <!-- Hero and Optimizer Section -->
        <section id="optimizer" class="w-full flex flex-col justify-center items-center py-16 radial-gradient-background">
            <div class="scroll-animate text-center">
                <h1 class="text-6xl md:text-8xl font-extrabold mb-4 leading-tight">Midjourney</h1>
                <h2 class="text-5xl md:text-7xl font-bold text-center mb-12">Prompt Optimizer</h2>
                <p class="text-xl md:text-2xl text-gray-300 max-w-3xl mx-auto mb-12">Transform your simple ideas into structured, powerful Midjourney prompts that generate exactly what you envision.</p>
            </div>
            <div class="w-full max-w-4xl scroll-animate">
                
                
                <!-- Input Form -->
                <div class="bg-[#111] border border-[#222] rounded-2xl p-8 mb-8 radial-gradient-background">
                    <form id="promptForm">
                        <label for="userPrompt" class="block text-xl font-semibold mb-4">Describe your vision:</label>
                        <textarea 
                            id="userPrompt" 
                            class="w-full bg-[#222] border border-[#333] rounded-xl p-4 text-white resize-none focus:outline-none focus:border-blue-500 transition-colors" 
                            rows="4" 
                            placeholder="e.g., A student studying at a desk with books, dreaming of the future with technology and space exploration"
                        ></textarea>
                        <input type="file" id="imageFile" accept="image/*" class="mt-4"> <!-- For upload -->
                        <input type="text" id="imageUrl" placeholder="Or enter image URL" class="mt-4 w-full bg-[#222] border border-[#333] rounded-xl p-4 text-white resize-none focus:outline-none focus:border-blue-500 transition-colors"> <!-- Optional for URL -->
                        <button 
                            type="submit"
                            id="optimizeBtn" 
                            class="mt-6 bg-blue-600 hover:bg-blue-500 text-white font-semibold py-3 px-8 rounded-full transition-colors col-span-full sm:col-span-1"
                        >
                            Optimize Prompt
                        </button>
                        <button 
                            type="button"
                            id="clearBtn" 
                            class="mt-6 ml-4 bg-red-600 hover:bg-red-500 text-white font-semibold py-3 px-8 rounded-full transition-colors col-span-1"
                        >
                            Clear
                        </button>
                    </form>
                </div>

                <!-- Output Section -->
                <div id="outputSection" class="bg-[#111] border border-[#222] rounded-2xl p-8 opacity-0 transition-opacity duration-500">
                    <h3 class="text-2xl font-bold mb-4 text-green-400">Optimized Prompt:</h3>
                    <div id="optimizedOutput" class="bg-[#222] border border-[#333] rounded-xl p-4 text-gray-300 leading-relaxed min-h-[120px] flex items-center">
                        <span class="text-gray-500">Your optimized prompt will appear here...</span>
                    </div>
                    <button 
                        id="copyBtn" 
                        class="mt-4 bg-green-600 hover:bg-green-500 text-white font-semibold py-2 px-6 rounded-full transition-colors opacity-0"
                    >
                        Copy to Clipboard
                    </button>
                </div>
            </div>
        </section>

        <!-- About Section -->
        <section id="about" class="w-full flex flex-col justify-center items-center py-16 bg-black">
             <div class="w-full max-w-6xl scroll-animate">
                <h2 class="text-5xl md:text-7xl font-bold text-center mb-12">How It Works</h2>
                <div class="flex flex-col items-center gap-8">
                    <div class="bg-[#111] border border-[#222] rounded-2xl p-8 text-center w-full md:w-2/3">
                        <div class="w-16 h-16 bg-blue-600 rounded-full flex items-center justify-center mx-auto mb-4">
                            <span class="text-2xl font-bold">1</span>
                        </div>
                        <h3 class="text-xl font-bold mb-4">Structure</h3>
                        <p class="text-gray-300">Your prompt is organized into Foreground, Midground, Background, and Style components for maximum clarity.</p>
                    </div>
                    <div class="bg-[#111] border border-[#222] rounded-2xl p-8 text-center w-full md:w-2/3">
                        <div class="w-16 h-16 bg-blue-600 rounded-full flex items-center justify-center mx-auto mb-4">
                            <span class="text-2xl font-bold">2</span>
                        </div>
                        <h3 class="text-xl font-bold mb-4">Detail</h3>
                        <p class="text-gray-300">Each layer is enhanced with specific details that guide Midjourney's AI to understand your exact vision.</p>
                    </div>
                    <div class="bg-[#111] border border-[#222] rounded-2xl p-8 text-center w-full md:w-2/3">
                        <div class="w-16 h-16 bg-blue-600 rounded-full flex items-center justify-center mx-auto mb-4">
                            <span class="text-2xl font-bold">3</span>
                        </div>
                        <h3 class="text-xl font-bold mb-4">Consistency</h3>
                        <p class="text-gray-300">The structured format ensures reproducible results and makes it easy to iterate on your designs.</p>
                    </div>
                </div>
                <div class="text-center mt-12">
                    <a href="examples.html" class="bg-blue-600 hover:bg-blue-500 text-white font-semibold py-3 px-8 rounded-full transition-colors">
                        See Examples
                    </a>
                </div>
            </div>
        </section>

    </main>

    <!-- Footer -->
    <footer class="container mx-auto px-8 py-12 text-center text-gray-500 text-sm">
        <p>Built for better prompts. © 2024</p>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Scroll animations (no changes here)
            const scrollElements = document.querySelectorAll('.scroll-animate');
            const elementInView = (el) => el.getBoundingClientRect().top <= (window.innerHeight || document.documentElement.clientHeight) - 100;
            const handleScrollAnimation = () => scrollElements.forEach(el => { if (elementInView(el)) el.classList.add('is-visible'); });
            window.addEventListener('scroll', handleScrollAnimation);
            handleScrollAnimation();

            // --- Prompt optimizer functionality (UPDATED) ---
            const userPrompt = document.getElementById('userPrompt');
            const optimizeBtn = document.getElementById('optimizeBtn');
            const outputSection = document.getElementById('outputSection');
            const optimizedOutput = document.getElementById('optimizedOutput');
            const copyBtn = document.getElementById('copyBtn');
            const clearBtn = document.getElementById('clearBtn');
            const form = document.getElementById('promptForm');

            form.addEventListener('submit', async (e) => {
                e.preventDefault();
                const userPrompt = document.getElementById('userPrompt').value;
                const imageFile = document.getElementById('imageFile').files[0];
                const imageUrl = document.getElementById('imageUrl').value;

                const formData = new FormData();
                formData.append('userPrompt', userPrompt);
                if (imageFile) formData.append('image', imageFile); // Send file
                if (imageUrl) formData.append('imageUrl', imageUrl); // Or URL

                // Show a loading state
                optimizeBtn.disabled = true;
                optimizeBtn.textContent = 'Optimizing...';
                optimizedOutput.innerHTML = '<span class="text-gray-500">The AI is thinking...</span>';
                outputSection.style.opacity = '1';

                try {
                    // Call our secure serverless function
                    const response = await fetch('/api/optimize', {
                        method: 'POST',
                        body: formData, // Handles files automatically
                    });

                    if (!response.ok) {
                        const errorData = await response.json();
                        throw new Error(errorData.error || 'Something went wrong.');
                    }

                    const data = await response.json();
                    
                    // Display the result from the AI
                    optimizedOutput.textContent = data.optimizedText;
                    copyBtn.style.opacity = '1';

                } catch (err) {
                    console.error('Error optimizing prompt:', err);
                    optimizedOutput.textContent = `Error: ${err.message}`;
                } finally {
                    // Reset the button
                    optimizeBtn.disabled = false;
                    optimizeBtn.textContent = 'Optimize Prompt';
                }
            });

            // --- Clear button functionality ---
            clearBtn.addEventListener('click', () => {
                userPrompt.value = '';
                document.getElementById('imageFile').value = ''; // Clear file input
                document.getElementById('imageUrl').value = ''; // Clear URL input
                optimizedOutput.innerHTML = '<span class="text-gray-500">Your optimized prompt will appear here...</span>';
                outputSection.style.opacity = '0';
                copyBtn.style.opacity = '0';
            });

            // --- Copy button functionality (no changes here) ---
            copyBtn.addEventListener('click', async () => {
                try {
                    await navigator.clipboard.writeText(optimizedOutput.textContent);
                    copyBtn.textContent = 'Copied!';
                    copyBtn.classList.remove('bg-green-600', 'hover:bg-green-500');
                    copyBtn.classList.add('bg-green-800');
                    
                    setTimeout(() => {
                        copyBtn.textContent = 'Copy to Clipboard';
                        copyBtn.classList.add('bg-green-600', 'hover:bg-green-500');
                        copyBtn.classList.remove('bg-green-800');
                    }, 2000);
                } catch (err) {
                    console.error('Failed to copy text: ', err);
                }
            });
        });
    </script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const currentPath = window.location.pathname.split('/').pop();
            const navLinks = document.querySelectorAll('nav a');

            navLinks.forEach(link => {
                const linkPath = link.getAttribute('href').split('/').pop().split('#')[0]; // Get filename without hash
                
                // Special handling for index.html as its href is index.html#optimizer
                if (currentPath === '' && linkPath === 'index.html') {
                    link.classList.add('font-semibold', 'text-blue-400');
                    link.classList.remove('hover:text-gray-300');
                } else if (currentPath === linkPath) {
                    link.classList.add('font-semibold', 'text-blue-400');
                    link.classList.remove('hover:text-gray-300');
                } else {
                    link.classList.remove('font-semibold', 'text-blue-400');
                    link.classList.add('hover:text-gray-300');
                }
            });
        });
    </script>
</body>
</html>
